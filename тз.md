








**ТЕХНИЧЕСКОЕ ЗАДАНИЕ**

**на разработку Сервиса Уведомлений (Notification Service)**













Бишкек 2025 

**СОДЕРЖАНИЕ**

[**1. ОБЩИЕ СВЕДЕНИЯ О СЕРВИСЕ (Notification Service)**](#_heading=h.ykgignh4jvh3)

[1.1. Полное наименование системы](#_heading=h.5nfu1xshmx4t)

[1.2. Назначение системы](#_heading=h.l296jb9y3505)

[1.3. Цели создания системы](#_heading=h.lwmexqxb7n6o)

[**2. ОБЗОР ТРЕБОВАНИЙ К СЕРВИСУ УВЕДОМЛЕНИЙ**](#_heading=h.rl7bolg2b8v6)

[2.1. Функциональные требования](#_heading=h.iszccoyzsv0)

[2.2. Нефункциональные требования](#_heading=h.jua33nozl5kz)

[2.3. Общие технические требования (Стек технологий)](#_heading=h.ih89ksqw2fl4)

[2.4. Требования к численности и квалификации персонала](#_heading=h.personnel)

[2.5. Требования к надежности](#_heading=h.pq03atew9tux)

[2.6. Требования к эргономике и технической эстетике](#_heading=h.ergonomics)

[2.7. Требования к защите информации от несанкционированного доступа](#_heading=h.security)

[2.8. Требования к информационному обеспечению](#_heading=h.info)

[**3. АРХИТЕКТУРА СИСТЕМЫ И ИНТЕРФЕЙСА**](#_heading=h.5b8zbkinhse7)

[3.1. Общая архитектура системы](#_heading=h.architecture)

[3.2. Структура Административной панели (React)](#_heading=h.qwbozs2x3zd2)

[3.3. Структура API взаимодействия](#_heading=h.dj96mc752r2r)

[**4. БАЗЫ ДАННЫХ СЕРВИСА**](#_heading=h.ffh7cz299nmg)

[4.1. Справочник «Журнал уведомлений» (Notifications)](#_heading=h.8zvpfum98q5v)

[4.2. Справочник «Клиенты API» (Api_Clients)](#_heading=h.dpc6ciotbdoi)

[4.3. Справочник «Конфигурация каналов» (Channel_Configs)](#_heading=h.fmebufnu6js3)

[4.4. Справочник «Администраторы» (Admins)](#_heading=h.admins)

[4.5. Справочник «Шаблоны сообщений» (Message_Templates)](#_heading=h.templates)

[4.6. Справочник «Очередь повторных отправок» (Retry_Queue)](#_heading=h.retry)

[**5. СОСТАВ И СОДЕРЖАНИЕ РАБОТ**](#_heading=h.vy05qt4w5aq7)

[**6. ПОРЯДОК КОНТРОЛЯ И ПРИЕМКИ**](#_heading=h.evzmigltljap)

[6.1. Общие требования к приемке работ](#_heading=h.acceptance)

[**7. ТРЕБОВАНИЯ К СОСТАВУ И СОДЕРЖАНИЮ РАБОТ ПО ПОДГОТОВКЕ К ВВОДУ В ЭКСПЛУАТАЦИЮ**](#_heading=h.preparation)

[**8. ТРЕБОВАНИЯ К ДОКУМЕНТИРОВАНИЮ**](#_heading=h.ll3f4tprsmuc)

---

**ПЕРЕЧЕНЬ ТЕРМИНОВ И СОКРАЩЕНИЙ**

Термины и определения, используемые в документе, приведены в таблице 1.

**Таблица 1. Перечень терминов и сокращений**

|**Термин/сокращение**|**Определение**|**Источник**|
| :-: | :-: | :-: |
|NS (Notification Service)|Сервис уведомлений — микросервис для централизованной отправки сообщений по различным каналам связи|В рамках данного документа|
|API (Application Programming Interface)|Программный интерфейс приложения, набор методов для взаимодействия между программными компонентами|Общепринятый термин|
|REST (Representational State Transfer)|Архитектурный стиль взаимодействия компонентов распределённого приложения в сети|Общепринятый термин|
|JWT (JSON Web Token)|Открытый стандарт для создания токенов доступа, основанный на формате JSON|RFC 7519|
|SMTP (Simple Mail Transfer Protocol)|Протокол для передачи электронной почты|RFC 5321|
|Retry Logic|Логика повторных попыток отправки сообщения при временных сбоях|В рамках данного документа|
|Fallback|Резервный канал доставки при недоступности основного канала|В рамках данного документа|
|Middleware|Промежуточное программное обеспечение, связывающее различные приложения|Общепринятый термин|
|TTL (Time To Live)|Время жизни сообщения в системе до его удаления или пометки как устаревшего|Общепринятый термин|
|Webhook|Механизм обратного вызова для уведомления внешних систем о событиях|Общепринятый термин|
|Rate Limiting|Ограничение частоты запросов к API для предотвращения перегрузки|Общепринятый термин|
|Dead Letter Queue (DLQ)|Очередь для сообщений, которые не удалось доставить после всех попыток|Общепринятый термин|
|Idempotency|Свойство операции давать одинаковый результат при многократном выполнении|Общепринятый термин|




---

<a name="_heading=h.ykgignh4jvh3"></a>**1. ОБЩИЕ СВЕДЕНИЯ О СЕРВИСЕ (Notification Service)**

<a name="_heading=h.5nfu1xshmx4t"></a>**1.1. Полное наименование системы**

**Полное наименование:** Сервис Уведомлений (Notification Service, NS).

Система представляет собой микросервис (middleware), обеспечивающий централизованное управление исходящими сообщениями. Сервис выступает единой точкой интеграции между бизнес-приложениями организации и внешними провайдерами связи, абстрагируя сложность работы с различными каналами доставки.

<a name="_heading=h.l296jb9y3505"></a>**1.2. Назначение системы**

Сервис предназначен для создания единой точки входа для отправки уведомлений от различных бизнес-приложений пользователям. Он предоставляет унифицированный API, скрывающий сложность взаимодействия с конкретными провайдерами связи (SMS-шлюзы, почтовые серверы, мессенджеры).

**Основные задачи системы:**

- Приём запросов на отправку уведомлений от внешних систем через единый REST API.
- Валидация входящих данных и маршрутизация сообщений по соответствующим каналам.
- Обеспечение гарантированной доставки с механизмами повторных попыток.
- Ведение полного журнала всех операций для аудита и отладки.
- Предоставление административного интерфейса для мониторинга и управления.

<a name="_heading=h.lwmexqxb7n6o"></a>**1.3. Цели создания системы**

Главной целью является создание надежного и удобного инструмента, который берет на себя следующие задачи:

1. **Унификация:** Предоставление простого API для внешних систем, независимо от канала доставки. Внешние системы работают с единым форматом запросов, не заботясь о специфике каждого провайдера.

2. **Маршрутизация:** Автоматический выбор подходящего канала (Email, Telegram, WhatsApp, SMS) на основе данных получателя и настроек приоритетов.

3. **Надежность:** Обеспечение гарантированной доставки и автоматические повторные попытки (retry) при ошибках с экспоненциальной задержкой.

4. **Контроль:** Ведение полных журналов (логов) всех отправок с возможностью отслеживания статуса каждого сообщения.

5. **Масштабируемость:** Возможность обработки растущего объёма уведомлений без изменения архитектуры внешних систем.

6. **Экономия ресурсов:** Централизация логики отправки уведомлений снижает дублирование кода в различных бизнес-приложениях.

7. **Мониторинг и аналитика:** Сбор статистики по каналам доставки, успешности отправок и времени отклика провайдеров.

<a name="_heading=h.rl7bolg2b8v6"></a>**2. ОБЗОР ТРЕБОВАНИЙ К СЕРВИСУ УВЕДОМЛЕНИЙ**

<a name="_heading=h.iszccoyzsv0"></a>**2.1. Функциональные требования**

Функциональные требования определяют перечень задач, которые должен выполнять Сервис. Функциональные требования описывают действия, которые пользователи и внешние системы могут выполнять с сервисом, а также ожидаемые результаты этих действий.

**2.1.1. Отправка и Маршрутизация**

- **Единый API:** Прием JSON-запросов от внешних систем с данными получателя и телом сообщения через RESTful API.
- **Поддержка каналов:** Система должна поддерживать интеграцию со следующими каналами:
  - E-mail (SMTP) — поддержка HTML и plain-text форматов, вложений до 10 МБ
  - Telegram (Bot API) — поддержка форматирования Markdown, inline-кнопок
  - WhatsApp (Business API) — поддержка шаблонных и произвольных сообщений
  - SMS (интеграция с агрегаторами) — поддержка Unicode и латиницы
- **Валидация:** Проверка корректности входящих данных (формат email по RFC 5322, номера телефона по E.164, chat_id для Telegram) перед отправкой.
- **Приоритизация:** Поддержка приоритетов сообщений (HIGH, NORMAL, LOW) для управления очередью отправки.
- **Шаблоны сообщений:** Поддержка шаблонов с подстановкой переменных для типовых уведомлений.

**2.1.2. Логика обработки ошибок**

- **Retry Logic (Повторные попытки):** При получении временной ошибки от провайдера (например, «сервис недоступен», HTTP 5xx), система должна автоматически ставить сообщение в очередь на повторную отправку. Интервалы повторов: 1 мин, 5 мин, 15 мин, 1 час, 4 часа (экспоненциальная задержка с максимумом 5 попыток).
- **Fallback (Резервные каналы):** Если доставка по приоритетному каналу (например, Telegram) невозможна после всех попыток, система должна пытаться отправить сообщение по резервному каналу (например, SMS), если он указан в конфигурации.
- **Dead Letter Queue:** Сообщения, не доставленные после всех попыток по всем каналам, помещаются в отдельную очередь для ручного разбора.
- **Идемпотентность:** Поддержка idempotency_key для предотвращения дублирования отправок при повторных запросах от клиента.

**2.1.3. Администрирование и Безопасность**

- **Аутентификация клиентов:** Внешние системы должны авторизовываться по API Key (передаётся в заголовке X-API-Key) или JWT Token (Bearer-схема).
- **Вход в админ-панель:** Реализация входа (Login) и регистрации администраторов (Sign up) с использованием Spring Security и JWT.
- **Ролевая модель:** Поддержка ролей ADMIN (полный доступ) и VIEWER (только просмотр журналов и статистики).
- **Rate Limiting:** Ограничение частоты запросов для каждого API-клиента (по умолчанию 100 запросов в минуту).
- **Аудит действий:** Логирование всех действий администраторов (изменение конфигурации, управление клиентами).

**2.1.4. Мониторинг и Статистика**

- **Дашборд:** Отображение ключевых метрик в реальном времени (количество отправок, ошибок, среднее время доставки).
- **Отчёты:** Формирование отчётов по каналам, клиентам и временным периодам.
- **Алерты:** Уведомление администраторов при превышении порога ошибок (например, >10% за последний час).
- **Health Check:** Эндпоинт для проверки работоспособности сервиса и подключения к провайдерам.

**2.1.5. Webhooks (Обратные вызовы)**

- **Callback URL:** Возможность указать URL для получения уведомлений о статусе доставки.
- **События:** Поддержка событий: SENT, DELIVERED, FAILED, CLICKED (для Email с трекингом).
- **Подпись запросов:** Подпись webhook-запросов для верификации подлинности на стороне клиента.

<a name="_heading=h.jua33nozl5kz"></a>**2.2. Нефункциональные требования**

Нефункциональные требования определяют аспекты качества, производительности и безопасности сервиса, которые не связаны с конкретными функциями, но влияют на общую работоспособность и эффективность системы.

**2.2.1. Производительность**

- Время отклика API на прием заявки не более 200 мс (95-й перцентиль).
- Асинхронная обработка отправки для предотвращения блокировки клиента.
- Пропускная способность: не менее 1000 сообщений в минуту при типовой нагрузке.
- Пиковая нагрузка: до 5000 сообщений в минуту без деградации качества.

**2.2.2. Масштабируемость**

- Возможность горизонтального масштабирования (запуск нескольких экземпляров сервиса) через Docker и оркестрацию контейнеров.
- Stateless-архитектура для обеспечения балансировки нагрузки между экземплярами.
- Поддержка кластерного режима работы с базой данных.

**2.2.3. Логирование и Мониторинг**

- Подробное логирование всех этапов жизненного цикла сообщения (Received -> Validated -> Queued -> Sending -> Sent/Failed).
- Структурированные логи в формате JSON для интеграции с системами сбора логов (ELK, Loki).
- Метрики в формате Prometheus для интеграции с системами мониторинга.
- Correlation ID для сквозной трассировки запросов.

**2.2.4. Совместимость**

- API должен соответствовать спецификации OpenAPI 3.0.
- Поддержка версионирования API (v1, v2) для обратной совместимости.
- Документация API через Swagger UI.

**2.2.5. Доступность**

- Целевой показатель доступности (SLA): 99.5% в месяц.
- Максимальное время простоя для планового обслуживания: 4 часа в месяц.
- Сервис должен эксплуатироваться в круглосуточном режиме (24/7).

<a name="_heading=h.ih89ksqw2fl4"></a>**2.3. Общие технические требования (Стек технологий)**

Разрабатываемое ПО должно соответствовать следующему технологическому стеку:

**Бэкенд:**
- **Язык программирования:** Java 17 (LTS).
- **Фреймворк:** Spring Boot 3.x.
- **База данных:** PostgreSQL 15+.
- **Доступ к данным:** Spring JDBC (JdbcClient).
- **Безопасность:** Spring Security 6.x с JWT-аутентификацией.
- **Валидация:** Jakarta Bean Validation (Hibernate Validator).
- **Логирование:** SLF4J + Logback.

**Фронтенд (Админ-панель):**
- **Фреймворк:** React 18+.
- **Язык:** TypeScript.
- **UI-библиотека:** Ant Design или Material-UI.
- **HTTP-клиент:** Axios.
- **Управление состоянием:** React Query или Redux Toolkit.

**Инфраструктура:**
- **Контейнеризация:** Docker, Docker Compose.
- **Сборка:** Maven или Gradle.
- **CI/CD:** GitHub Actions / GitLab CI (опционально).

**Интеграции с провайдерами:**
- SMTP-сервер (любой, поддерживающий STARTTLS/SSL).
- Telegram Bot API (официальный API).
- WhatsApp Business API (через официальных партнёров Meta).
- SMS-агрегаторы (Twilio, Nexmo или локальные провайдеры).

<a name="_heading=h.personnel"></a>**2.4. Требования к численности и квалификации персонала**

Для эксплуатации и поддержки Сервиса Уведомлений необходим минимум один сотрудник со следующими ролями:

**Сотрудник 1 (Администратор системы):**

1. **Системное администрирование:**
   - Мониторинг работоспособности сервиса и провайдеров каналов связи.
   - Управление Docker-контейнерами и инфраструктурой.
   - Анализ логов и устранение инцидентов.
   - Системный администратор должен обладать знаниями Linux, Docker, PostgreSQL и основами работы с Java-приложениями.

2. **Управление конфигурацией каналов:**
   - Настройка подключений к провайдерам (SMTP, Telegram Bot, SMS-шлюзы).
   - Мониторинг лимитов и квот провайдеров.
   - Ротация API-ключей и токенов.

3. **Управление API-клиентами:**
   - Создание и деактивация учётных записей внешних систем.
   - Настройка лимитов запросов для клиентов.
   - Генерация и отзыв API-ключей.

4. **Резервное копирование:**
   - Настройка и контроль регулярного резервного копирования БД.
   - Проверка процедур восстановления.

**Режим работы:**
- Сервис функционирует в автоматическом режиме 24/7.
- Администратор доступен в рабочее время для разрешения инцидентов.
- Критические алерты должны доставляться администратору в нерабочее время.

<a name="_heading=h.pq03atew9tux"></a>**2.5. Требования к надежности**

Для обеспечения надежности Сервиса Уведомлений необходимо учесть следующие требования:

**2.5.1. Отказоустойчивость**

- Сбои в работе внешних провайдеров (например, Telegram API недоступен) не должны приводить к потере сообщений внутри системы.
- Сообщения должны сохраняться в БД до успешной отправки или истечения срока жизни (TTL по умолчанию — 24 часа).
- При недоступности одного канала система автоматически переключается на резервный (при наличии конфигурации).
- Отказы и сбои в работе сетевого оборудования не должны приводить к разрушению данных.

**2.5.2. Сохранность данных**

- Регулярное резервное копирование БД PostgreSQL (ежедневно с хранением 30 дней).
- Все транзакции должны быть атомарными — сообщение либо полностью сохранено, либо не сохранено.
- Журнал уведомлений должен храниться не менее 90 дней для аудита.

**2.5.3. Обработка ошибок**

- Должна обеспечиваться корректная обработка ошибочных ситуаций с возможностью продолжения работы.
- При получении невалидных данных от клиента — возврат информативного сообщения об ошибке (HTTP 400).
- При внутренних ошибках — логирование и возврат HTTP 500 без раскрытия деталей реализации.
- Circuit Breaker для защиты от каскадных сбоев при проблемах с провайдерами.

**2.5.4. Восстановление после сбоев**

- Время восстановления после сбоя (RTO): не более 1 часа.
- Допустимая потеря данных (RPO): не более 1 часа (определяется частотой бэкапов).
- Наличие документированной процедуры восстановления.

**2.5.5. Тестирование надежности**

- Проведение тестов на отказоустойчивость перед вводом в эксплуатацию.
- Периодическое тестирование процедур восстановления из резервных копий.
- Нагрузочное тестирование для проверки поведения при пиковых нагрузках.

<a name="_heading=h.ergonomics"></a>**2.6. Требования к эргономике и технической эстетике**

Административная панель должна обеспечивать удобное взаимодействие для операторов и администраторов системы.

**2.6.1. Общие требования к интерфейсу**

1. **Понятность и удобство:** Графический интерфейс должен быть интуитивно понятным и удобным. Навигация должна быть простой и логичной.

2. **Адаптивный дизайн:** Корректное отображение на экранах с разрешением от 1280x720 до 1920x1080 и выше.

3. **Совместимость с браузерами:** Поддержка актуальных версий Google Chrome, Mozilla Firefox, Microsoft Edge, Safari.

4. **Время отклика интерфейса:** Загрузка страниц не более 2 секунд, отклик на действия пользователя не более 300 мс.

5. **Русскоязычный интерфейс:** Все надписи, сообщения и подсказки должны быть на русском языке.

**2.6.2. Требования к визуальному оформлению**

1. **Единый стиль:** Использование единой цветовой схемы и типографики во всём интерфейсе.

2. **Информативные сообщения:** Чёткие сообщения об успешных операциях и ошибках.

3. **Визуализация данных:** Наглядные графики и диаграммы для статистики.

4. **Индикация состояний:** Цветовая индикация статусов (зелёный — успех, красный — ошибка, жёлтый — в обработке).

<a name="_heading=h.security"></a>**2.7. Требования к защите информации от несанкционированного доступа**

**2.7.1. Аутентификация и авторизация**

1. **Аутентификация администраторов:**
   - Вход по логину и паролю с обязательной сложностью (минимум 8 символов, буквы и цифры).
   - JWT-токены с ограниченным сроком жизни (по умолчанию 8 часов).
   - Блокировка учётной записи после 5 неудачных попыток входа.

2. **Аутентификация API-клиентов:**
   - Аутентификация по API Key (передаётся в заголовке).
   - Возможность отзыва ключа без влияния на другие системы.
   - Логирование всех API-запросов с идентификацией клиента.

3. **Управление доступом:**
   - Ролевая модель доступа (RBAC).
   - Принцип минимальных привилегий.
   - Ограничение доступа к административной панели по IP (опционально).

**2.7.2. Защита данных**

1. **Шифрование:**
   - Все соединения через HTTPS (TLS 1.2+).
   - Пароли хранятся в виде bcrypt-хэшей.
   - API-ключи хранятся в виде SHA-256 хэшей.

2. **Защита чувствительных данных:**
   - Credentials провайдеров хранятся в зашифрованном виде в БД.
   - Маскирование персональных данных в логах.

**2.7.3. Защита от атак**

1. **Защита API:**
   - Rate Limiting для предотвращения DDoS и brute-force атак.
   - Валидация всех входящих данных для защиты от инъекций.
   - CORS-политика для защиты от межсайтовых запросов.

2. **Мониторинг безопасности:**
   - Логирование подозрительных действий (множественные неудачные попытки входа).
   - Алерты при обнаружении аномальной активности.

**2.7.4. Аудит**

- Логирование всех действий администраторов.
- Сохранение истории изменений конфигурации.
- Невозможность удаления логов аудита.

<a name="_heading=h.info"></a>**2.8. Требования к информационному обеспечению**

**2.8.1. Документация API**

- Интерактивная документация Swagger UI доступна по адресу /swagger-ui.
- OpenAPI-спецификация в формате JSON/YAML для автогенерации клиентов.
- Примеры запросов и ответов для каждого эндпоинта.
- Описание кодов ошибок и способов их обработки.

**2.8.2. Справочная информация**

- Руководство администратора с описанием настройки каналов.
- Инструкция по интеграции для разработчиков внешних систем.
- FAQ по типовым проблемам и их решениям.

**2.8.3. Мониторинг и отчётность**

- Дашборд с ключевыми метриками в реальном времени.
- Возможность экспорта данных журнала в CSV/Excel.
- Графики динамики отправок по дням/часам.

<a name="_heading=h.5b8zbkinhse7"></a>**3. АРХИТЕКТУРА СИСТЕМЫ И ИНТЕРФЕЙСА**

<a name="_heading=h.architecture"></a>**3.1. Общая архитектура системы**

Сервис Уведомлений построен по принципу микросервисной архитектуры и состоит из следующих компонентов:

**3.1.1. Компоненты системы**

```
┌─────────────────────────────────────────────────────────────────┐
│                     Внешние системы (CRM, ERP, Site)            │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼ REST API (HTTPS)
┌─────────────────────────────────────────────────────────────────┐
│                    API Gateway / Load Balancer                  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                 Notification Service (Spring Boot)              │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐    │
│  │ API Layer │  │ Validator │  │  Router   │  │  Sender   │    │
│  └───────────┘  └───────────┘  └───────────┘  └───────────┘    │
└─────────────────────────────────────────────────────────────────┘
         │                                            │
         ▼                                            ▼
┌─────────────────┐                    ┌─────────────────────────┐
│   PostgreSQL    │                    │   Channel Providers     │
│   (Хранение)    │                    │  ┌─────┐ ┌────┐ ┌────┐  │
└─────────────────┘                    │  │SMTP │ │ TG │ │SMS │  │
                                       │  └─────┘ └────┘ └────┘  │
                                       └─────────────────────────┘
```

**3.1.2. Слои приложения**

1. **API Layer (Контроллеры):**
   - Приём HTTP-запросов от внешних систем.
   - Аутентификация и авторизация.
   - Первичная валидация входных данных.
   - Формирование HTTP-ответов.

2. **Service Layer (Бизнес-логика):**
   - Валидация бизнес-правил.
   - Маршрутизация по каналам.
   - Управление очередью повторных отправок.
   - Формирование статистики.

3. **Integration Layer (Интеграции):**
   - Адаптеры для каждого канала (Email, Telegram, WhatsApp, SMS).
   - Обработка ответов от провайдеров.
   - Преобразование форматов сообщений.

4. **Data Layer (Доступ к данным):**
   - Репозитории для работы с БД.
   - Кэширование конфигурации каналов.

**3.1.3. Поток обработки сообщения**

1. Внешняя система отправляет POST-запрос на `/api/v1/send`.
2. API Layer проверяет API Key и валидирует JSON.
3. Сообщение сохраняется в БД со статусом `PENDING`.
4. Клиенту возвращается HTTP 202 Accepted с `notification_id`.
5. Асинхронный обработчик извлекает сообщение из очереди.
6. Router определяет канал доставки.
7. Sender отправляет сообщение через соответствующий адаптер.
8. Статус обновляется на `SENT` или `FAILED`.
9. При ошибке сообщение помещается в очередь повторных попыток.

<a name="_heading=h.qwbozs2x3zd2"></a>**3.2. Структура Административной панели (React)**

Административная панель предназначена для мониторинга и настройки сервиса сотрудниками техподдержки.

**3.2.1. Окно Авторизации**

Стандартная форма входа с полями:
- Логин (email администратора).
- Пароль.
- Кнопка «Войти».
- Ссылка «Забыли пароль?» (опционально).

**3.2.2. Дашборд (Главная страница)**

После успешной авторизации отображается главная страница с ключевыми метриками:

- **Виджет статистики за сутки:**
  - Общее количество отправленных сообщений.
  - Количество успешных доставок.
  - Количество ошибок.
  - Процент успешности (Success Rate).

- **Распределение по каналам:**
  - Круговая диаграмма с долей каждого канала (Email, Telegram, WhatsApp, SMS).

- **График активности:**
  - Линейный график отправок по часам за последние 24 часа.

- **Последние ошибки:**
  - Таблица с последними 10 неудачными отправками.

**3.2.3. Раздел «Журнал уведомлений»**

Страница с таблицей всех сообщений:

- **Колонки таблицы:**
  - ID уведомления.
  - Дата/время создания.
  - Канал.
  - Получатель.
  - Статус (с цветовой индикацией).
  - Количество попыток.
  - Действия.

- **Фильтры:**
  - По статусу (Успех/Ошибка/В обработке/Все).
  - По каналу.
  - По дате (диапазон).
  - По получателю (поиск).
  - По клиенту-отправителю.

- **Действия:**
  - Просмотр деталей сообщения.
  - Ручной перезапуск неудачных отправок.
  - Экспорт в CSV.

**3.2.4. Раздел «Клиенты API»**

Управление внешними системами:

- Таблица клиентов с информацией:
  - Название системы.
  - Статус (активен/заблокирован).
  - Дата создания.
  - Количество отправок.

- Действия:
  - Создание нового клиента.
  - Генерация/регенерация API Key.
  - Активация/деактивация.
  - Настройка лимитов.

**3.2.5. Раздел «Конфигурация каналов»**

Формы для настройки подключений к провайдерам:

- **Email (SMTP):**
  - Хост и порт SMTP-сервера.
  - Имя пользователя и пароль.
  - Email отправителя (From).
  - Настройки TLS/SSL.

- **Telegram:**
  - Bot Token.
  - Webhook URL (опционально).

- **WhatsApp:**
  - Account SID.
  - Auth Token.
  - Номер отправителя.

- **SMS:**
  - Выбор провайдера.
  - API Key / credentials провайдера.
  - Имя отправителя (Sender ID).

- Для каждого канала:
  - Переключатель «Включен/Выключен».
  - Кнопка «Проверить подключение».

**3.2.6. Раздел «Шаблоны сообщений»**

Управление шаблонами:

- Список шаблонов с названием и каналом.
- Редактор шаблона с поддержкой переменных ({{name}}, {{code}}).
- Предпросмотр сообщения.

**3.2.7. Навигация и структура**

- **Боковое меню:**
  - Дашборд.
  - Журнал уведомлений.
  - Клиенты API.
  - Конфигурация.
  - Шаблоны.
  - Настройки профиля.
  - Выход.

- **Верхняя панель:**
  - Название системы.
  - Имя текущего администратора.
  - Иконка уведомлений (алерты).

<a name="_heading=h.dj96mc752r2r"></a>**3.3. Структура API взаимодействия**

Система предоставляет RESTful API endpoints. Все эндпоинты возвращают JSON.

**3.3.1. Аутентификация**

| Метод | Эндпоинт | Описание |
|-------|----------|----------|
| POST | /api/v1/auth/login | Получение JWT-токена для админ-панели |
| POST | /api/v1/auth/refresh | Обновление JWT-токена |
| POST | /api/v1/auth/logout | Инвалидация токена |

**3.3.2. Отправка уведомлений (для внешних систем)**

| Метод | Эндпоинт | Описание |
|-------|----------|----------|
| POST | /api/v1/send | Отправка уведомления |
| POST | /api/v1/send/batch | Массовая отправка (до 100 сообщений) |
| GET | /api/v1/status/{id} | Проверка статуса доставки |
| GET | /api/v1/status | Статусы нескольких сообщений (по списку ID) |

**3.3.3. Примеры запросов**

**POST /api/v1/send**

Запрос:
```json
{
  "channel": "EMAIL",
  "recipient": "user@example.com",
  "subject": "Подтверждение регистрации",
  "message": "Ваш код подтверждения: 123456",
  "priority": "HIGH",
  "idempotency_key": "reg-12345-confirm",
  "callback_url": "https://your-system.com/webhook/notification",
  "metadata": {
    "user_id": "12345",
    "action": "registration"
  }
}
```

Ответ (HTTP 202 Accepted):
```json
{
  "notification_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "PENDING",
  "created_at": "2025-12-01T10:30:00Z"
}
```

**GET /api/v1/status/{id}**

Ответ:
```json
{
  "notification_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "SENT",
  "channel": "EMAIL",
  "recipient": "user@example.com",
  "created_at": "2025-12-01T10:30:00Z",
  "sent_at": "2025-12-01T10:30:05Z",
  "retry_count": 0
}
```

**3.3.4. Административные эндпоинты**

| Метод | Эндпоинт | Описание |
|-------|----------|----------|
| GET | /api/v1/admin/notifications | Список уведомлений с фильтрацией |
| GET | /api/v1/admin/notifications/{id} | Детали уведомления |
| POST | /api/v1/admin/notifications/{id}/retry | Повторная отправка |
| GET | /api/v1/admin/clients | Список API-клиентов |
| POST | /api/v1/admin/clients | Создание клиента |
| PUT | /api/v1/admin/clients/{id} | Обновление клиента |
| DELETE | /api/v1/admin/clients/{id} | Деактивация клиента |
| GET | /api/v1/admin/channels | Список каналов |
| PUT | /api/v1/admin/channels/{name} | Обновление конфигурации канала |
| POST | /api/v1/admin/channels/{name}/test | Тестовая отправка |
| GET | /api/v1/admin/stats | Статистика |
| GET | /api/v1/admin/stats/dashboard | Данные для дашборда |

**3.3.5. Служебные эндпоинты**

| Метод | Эндпоинт | Описание |
|-------|----------|----------|
| GET | /actuator/health | Проверка работоспособности |
| GET | /actuator/metrics | Метрики Prometheus |
| GET | /swagger-ui | Документация API |

**3.3.6. Коды ошибок**

| HTTP код | Описание |
|----------|----------|
| 200 | Успешный запрос |
| 201 | Ресурс создан |
| 202 | Запрос принят в обработку |
| 400 | Невалидные данные в запросе |
| 401 | Не авторизован (отсутствует или невалидный токен) |
| 403 | Доступ запрещён |
| 404 | Ресурс не найден |
| 429 | Превышен лимит запросов |
| 500 | Внутренняя ошибка сервера |
| 503 | Сервис временно недоступен |

<a name="_heading=h.ffh7cz299nmg"></a>**4. БАЗЫ ДАННЫХ СЕРВИСА**

Ниже приведено описание основных сущностей базы данных PostgreSQL. Все таблицы используют стандартные соглашения именования и включают поля аудита.

<a name="_heading=h.8zvpfum98q5v"></a>**4.1. Справочник «Журнал уведомлений» (notifications)**

Таблица предназначена для хранения истории всех запросов на отправку уведомлений.

|**Поле**|**Описание**|**Тип данных**|**Ограничения**|
| :- | :- | :- | :- |
|**notification_id**|Уникальный идентификатор сообщения|UUID|PRIMARY KEY, DEFAULT uuid_generate_v4()|
|**client_id**|ID системы-отправителя (внешний ключ)|INTEGER|NOT NULL, FK -> api_clients|
|**channel_type**|Тип канала (SMS, EMAIL, TELEGRAM, WHATSAPP)|VARCHAR(20)|NOT NULL|
|**recipient**|Адрес получателя (email, телефон, chat_id)|VARCHAR(255)|NOT NULL|
|**subject**|Тема сообщения (для email)|VARCHAR(500)|NULL|
|**message_body**|Текст сообщения|TEXT|NOT NULL|
|**status**|Текущий статус|VARCHAR(20)|NOT NULL, DEFAULT 'PENDING'|
|**priority**|Приоритет (HIGH, NORMAL, LOW)|VARCHAR(10)|NOT NULL, DEFAULT 'NORMAL'|
|**retry_count**|Количество попыток отправки|INTEGER|NOT NULL, DEFAULT 0|
|**max_retries**|Максимальное количество попыток|INTEGER|NOT NULL, DEFAULT 5|
|**next_retry_at**|Время следующей попытки|TIMESTAMP|NULL|
|**error_message**|Текст последней ошибки|TEXT|NULL|
|**error_code**|Код ошибки провайдера|VARCHAR(50)|NULL|
|**provider_message_id**|ID сообщения в системе провайдера|VARCHAR(255)|NULL|
|**idempotency_key**|Ключ идемпотентности|VARCHAR(255)|UNIQUE, NULL|
|**callback_url**|URL для webhook-уведомления|VARCHAR(500)|NULL|
|**metadata**|Дополнительные данные от клиента|JSONB|NULL|
|**created_at**|Дата и время создания|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**updated_at**|Дата и время обновления|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**sent_at**|Дата и время успешной отправки|TIMESTAMP|NULL|
|**expires_at**|Время истечения срока жизни (TTL)|TIMESTAMP|NULL|

**Индексы:**
- idx_notifications_status (status) — для фильтрации по статусу.
- idx_notifications_client_id (client_id) — для фильтрации по клиенту.
- idx_notifications_created_at (created_at DESC) — для сортировки по дате.
- idx_notifications_next_retry (next_retry_at) WHERE status = 'PENDING' — для очереди повторов.
- idx_notifications_idempotency (idempotency_key) — для проверки дубликатов.

**Статусы сообщений:**
- PENDING — принято в обработку.
- SENDING — отправляется.
- SENT — успешно отправлено.
- DELIVERED — подтверждена доставка (если провайдер поддерживает).
- FAILED — ошибка отправки (все попытки исчерпаны).
- EXPIRED — истёк срок жизни сообщения.

<a name="_heading=h.dpc6ciotbdoi"></a>**4.2. Справочник «Клиенты API» (api_clients)**

Хранит данные о внешних системах, которым разрешено пользоваться сервисом.

|**Поле**|**Описание**|**Тип данных**|**Ограничения**|
| :- | :- | :- | :- |
|**client_id**|Уникальный ID клиента|SERIAL|PRIMARY KEY|
|**client_name**|Название системы (напр. "CRM", "Site")|VARCHAR(100)|NOT NULL, UNIQUE|
|**client_description**|Описание системы|TEXT|NULL|
|**api_key_hash**|Хэш ключа доступа (SHA-256)|VARCHAR(64)|NOT NULL|
|**api_key_prefix**|Первые 8 символов ключа (для идентификации)|VARCHAR(8)|NOT NULL|
|**is_active**|Статус активности|BOOLEAN|NOT NULL, DEFAULT TRUE|
|**rate_limit**|Лимит запросов в минуту|INTEGER|NOT NULL, DEFAULT 100|
|**allowed_channels**|Разрешённые каналы|VARCHAR[]|NULL (все, если NULL)|
|**allowed_ips**|Белый список IP-адресов|INET[]|NULL (любой, если NULL)|
|**callback_url_default**|URL для webhook по умолчанию|VARCHAR(500)|NULL|
|**created_at**|Дата создания|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**updated_at**|Дата обновления|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**created_by**|ID администратора, создавшего запись|INTEGER|FK -> admins|
|**last_used_at**|Дата последнего использования|TIMESTAMP|NULL|

**Индексы:**
- idx_api_clients_api_key_hash (api_key_hash) — для быстрой аутентификации.
- idx_api_clients_active (is_active) WHERE is_active = TRUE.

<a name="_heading=h.fmebufnu6js3"></a>**4.3. Справочник «Конфигурация каналов» (channel_configs)**

Хранит настройки подключения к провайдерам, чтобы менять их без пересборки кода.

|**Поле**|**Описание**|**Тип данных**|**Ограничения**|
| :- | :- | :- | :- |
|**config_id**|ID настройки|SERIAL|PRIMARY KEY|
|**channel_name**|Название канала (EMAIL, TELEGRAM, SMS, WHATSAPP)|VARCHAR(20)|NOT NULL, UNIQUE|
|**provider_name**|Название провайдера|VARCHAR(50)|NOT NULL|
|**credentials**|JSON с ключами и паролями (зашифрованный)|BYTEA|NOT NULL|
|**settings**|Дополнительные настройки|JSONB|NULL|
|**is_enabled**|Включен ли канал|BOOLEAN|NOT NULL, DEFAULT FALSE|
|**priority**|Приоритет канала (для fallback)|INTEGER|NOT NULL, DEFAULT 0|
|**daily_limit**|Дневной лимит отправок|INTEGER|NULL|
|**daily_sent_count**|Отправлено за сегодня|INTEGER|NOT NULL, DEFAULT 0|
|**last_health_check**|Время последней проверки|TIMESTAMP|NULL|
|**health_status**|Статус работоспособности|VARCHAR(20)|DEFAULT 'UNKNOWN'|
|**created_at**|Дата создания|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**updated_at**|Дата обновления|TIMESTAMP|NOT NULL, DEFAULT NOW()|

**Примеры структуры settings:**

Для EMAIL:
```json
{
  "host": "smtp.example.com",
  "port": 587,
  "from_email": "noreply@example.com",
  "from_name": "Notification Service",
  "use_tls": true,
  "connection_timeout": 5000
}
```

Для TELEGRAM:
```json
{
  "parse_mode": "Markdown",
  "disable_web_page_preview": true
}
```

<a name="_heading=h.admins"></a>**4.4. Справочник «Администраторы» (admins)**

Хранит учётные записи администраторов системы.

|**Поле**|**Описание**|**Тип данных**|**Ограничения**|
| :- | :- | :- | :- |
|**admin_id**|ID администратора|SERIAL|PRIMARY KEY|
|**email**|Email (логин)|VARCHAR(255)|NOT NULL, UNIQUE|
|**password_hash**|Хэш пароля (bcrypt)|VARCHAR(60)|NOT NULL|
|**full_name**|ФИО|VARCHAR(200)|NOT NULL|
|**role**|Роль (ADMIN, VIEWER)|VARCHAR(20)|NOT NULL, DEFAULT 'VIEWER'|
|**is_active**|Статус активности|BOOLEAN|NOT NULL, DEFAULT TRUE|
|**failed_login_attempts**|Неудачные попытки входа|INTEGER|NOT NULL, DEFAULT 0|
|**locked_until**|Заблокирован до|TIMESTAMP|NULL|
|**last_login_at**|Дата последнего входа|TIMESTAMP|NULL|
|**last_login_ip**|IP последнего входа|INET|NULL|
|**created_at**|Дата создания|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**updated_at**|Дата обновления|TIMESTAMP|NOT NULL, DEFAULT NOW()|

<a name="_heading=h.templates"></a>**4.5. Справочник «Шаблоны сообщений» (message_templates)**

Хранит шаблоны типовых сообщений.

|**Поле**|**Описание**|**Тип данных**|**Ограничения**|
| :- | :- | :- | :- |
|**template_id**|ID шаблона|SERIAL|PRIMARY KEY|
|**template_code**|Уникальный код шаблона|VARCHAR(50)|NOT NULL, UNIQUE|
|**template_name**|Название шаблона|VARCHAR(200)|NOT NULL|
|**channel_type**|Тип канала|VARCHAR(20)|NOT NULL|
|**subject_template**|Шаблон темы (для email)|VARCHAR(500)|NULL|
|**body_template**|Шаблон тела сообщения|TEXT|NOT NULL|
|**variables**|Список переменных шаблона|VARCHAR[]|NOT NULL|
|**is_active**|Статус активности|BOOLEAN|NOT NULL, DEFAULT TRUE|
|**created_at**|Дата создания|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**updated_at**|Дата обновления|TIMESTAMP|NOT NULL, DEFAULT NOW()|
|**created_by**|ID создателя|INTEGER|FK -> admins|

**Пример шаблона:**
- template_code: "USER_REGISTRATION"
- body_template: "Здравствуйте, {{name}}! Ваш код подтверждения: {{code}}"
- variables: ["name", "code"]

<a name="_heading=h.retry"></a>**4.6. Справочник «Журнал аудита» (audit_log)**

Хранит историю действий администраторов.

|**Поле**|**Описание**|**Тип данных**|**Ограничения**|
| :- | :- | :- | :- |
|**log_id**|ID записи|BIGSERIAL|PRIMARY KEY|
|**admin_id**|ID администратора|INTEGER|FK -> admins|
|**action_type**|Тип действия|VARCHAR(50)|NOT NULL|
|**entity_type**|Тип сущности (client, channel, template)|VARCHAR(50)|NOT NULL|
|**entity_id**|ID сущности|VARCHAR(50)|NULL|
|**old_value**|Предыдущее значение|JSONB|NULL|
|**new_value**|Новое значение|JSONB|NULL|
|**ip_address**|IP-адрес|INET|NOT NULL|
|**user_agent**|User-Agent браузера|TEXT|NULL|
|**created_at**|Дата и время действия|TIMESTAMP|NOT NULL, DEFAULT NOW()|

**Типы действий (action_type):**
- LOGIN, LOGOUT — вход/выход.
- CREATE, UPDATE, DELETE — CRUD-операции.
- REGENERATE_KEY — перегенерация API-ключа.
- RETRY_NOTIFICATION — ручной перезапуск отправки.
- ENABLE_CHANNEL, DISABLE_CHANNEL — управление каналами.

**4.7. Схема связей между таблицами**

```
┌─────────────────┐       ┌─────────────────┐
│     admins      │       │   api_clients   │
├─────────────────┤       ├─────────────────┤
│ admin_id (PK)   │◄──┐   │ client_id (PK)  │◄──┐
│ email           │   │   │ client_name     │   │
│ password_hash   │   │   │ api_key_hash    │   │
│ role            │   │   │ is_active       │   │
└─────────────────┘   │   └─────────────────┘   │
        │             │           │             │
        │             │           │             │
        ▼             │           ▼             │
┌─────────────────┐   │   ┌─────────────────┐   │
│   audit_log     │   │   │  notifications  │   │
├─────────────────┤   │   ├─────────────────┤   │
│ log_id (PK)     │   │   │ notification_id │   │
│ admin_id (FK)───┼───┘   │ client_id (FK)──┼───┘
│ action_type     │       │ channel_type    │
│ entity_type     │       │ status          │
└─────────────────┘       └─────────────────┘
                                  │
┌─────────────────┐               │
│ channel_configs │               │
├─────────────────┤               │
│ config_id (PK)  │◄──────────────┘
│ channel_name    │   (логическая связь)
│ is_enabled      │
└─────────────────┘

┌─────────────────┐
│message_templates│
├─────────────────┤
│ template_id(PK) │
│ template_code   │
│ channel_type    │
│ body_template   │
└─────────────────┘
```

<a name="_heading=h.vy05qt4w5aq7"></a>**5. СОСТАВ И СОДЕРЖАНИЕ РАБОТ**

Работы выполняются в соответствии со следующими этапами:

|**Этап**|**Перечень работ**|**Отчетные материалы**|**Срок**|
| :- | :- | :- | :- |
|**Этап 1: Проектирование**|1. Анализ требований и уточнение ТЗ.<br>2. Проектирование архитектуры системы.<br>3. Проектирование структуры базы данных.<br>4. Разработка спецификации API (OpenAPI/Swagger).<br>5. Проектирование UI/UX админ-панели.|Техническое задание (согласованное), Схема БД (ER-диаграмма), Спецификация API (OpenAPI YAML), Макеты интерфейса.|2 недели|
|**Этап 2: Разработка бэкенда**|1. Настройка проекта Spring Boot и структуры модулей.<br>2. Реализация слоя доступа к данным (репозитории).<br>3. Реализация REST API для отправки уведомлений.<br>4. Реализация интеграции с Email (SMTP).<br>5. Реализация интеграции с Telegram Bot API.<br>6. Реализация интеграции с SMS-провайдером.<br>7. Реализация интеграции с WhatsApp API.<br>8. Реализация механизма Retry и очередей.<br>9. Реализация аутентификации и авторизации.<br>10. Реализация административных API.|Исходный код бэкенда, Unit-тесты, Интеграционные тесты.|4 недели|
|**Этап 3: Разработка фронтенда**|1. Настройка проекта React.<br>2. Разработка страницы авторизации.<br>3. Разработка дашборда со статистикой.<br>4. Разработка раздела «Журнал уведомлений».<br>5. Разработка раздела «Клиенты API».<br>6. Разработка раздела «Конфигурация каналов».<br>7. Разработка раздела «Шаблоны».<br>8. Интеграция с API бэкенда.|Исходный код фронтенда, Сборка для production.|3 недели|
|**Этап 4: Тестирование**|1. Функциональное тестирование всех модулей.<br>2. Интеграционное тестирование с реальными провайдерами.<br>3. Нагрузочное тестирование (1000+ сообщений/мин).<br>4. Тестирование безопасности.<br>5. Исправление выявленных дефектов.|Протокол тестирования, Отчёт о нагрузочном тестировании, Список исправленных багов.|2 недели|
|**Этап 5: Развёртывание и документация**|1. Подготовка Docker-образов.<br>2. Написание docker-compose для развёртывания.<br>3. Развёртывание на тестовом окружении Заказчика.<br>4. Разработка руководства администратора.<br>5. Разработка руководства по интеграции.<br>6. Настройка мониторинга и алертов.|Docker-образы, docker-compose.yml, Руководство администратора, Руководство по интеграции (Integration Guide), Инструкция по развёртыванию.|1 неделя|
|**Этап 6: Приёмка и передача**|1. Демонстрация системы Заказчику.<br>2. Обучение администраторов.<br>3. Передача исходного кода и документации.<br>4. Гарантийная поддержка (30 дней).|Акт сдачи-приёмки работ, Исходный код (репозиторий), Полный комплект документации.|1 неделя|

**Общая длительность проекта:** 13 недель (примерно 3 месяца).

**Диаграмма Ганта (упрощённая):**

```
Неделя:     1   2   3   4   5   6   7   8   9  10  11  12  13
Этап 1:     ████████
Этап 2:             ████████████████████████
Этап 3:                     ████████████████████
Этап 4:                                     ████████████
Этап 5:                                             ████████
Этап 6:                                                 ████
```

<a name="_heading=h.evzmigltljap"></a>**6. ПОРЯДОК КОНТРОЛЯ И ПРИЕМКИ**

<a name="_heading=h.acceptance"></a>**6.1. Общие требования к приемке работ**

6.1.1. Приемка работы осуществляется комиссией Заказчика в составе не менее двух человек.

6.1.2. Приёмка проводится поэтапно по завершении каждого этапа работ с оформлением промежуточных актов.

6.1.3. Финальная приёмка проводится после завершения всех этапов.

**6.2. Требования к демонстрации**

К приемке предъявляются:

1. **Развёрнутый сервис:**
   - Сервис развёрнут в Docker-контейнерах на инфраструктуре Заказчика.
   - База данных PostgreSQL настроена и содержит тестовые данные.
   - Административная панель доступна через веб-браузер.

2. **Демонстрация функциональности:**
   - Отправка тестовых сообщений во все заявленные каналы (Email, Telegram, WhatsApp, SMS).
   - Демонстрация работы механизма повторных попыток (симуляция недоступности провайдера).
   - Демонстрация fallback-механизма (переключение на резервный канал).
   - Демонстрация журнала уведомлений с фильтрацией.
   - Демонстрация создания и управления API-клиентами.
   - Демонстрация настройки каналов связи.
   - Демонстрация дашборда со статистикой.

3. **Проверка требований к производительности:**
   - Время отклика API менее 200 мс (демонстрация через инструменты тестирования).
   - Успешная обработка пакета из 100 сообщений.

4. **Проверка безопасности:**
   - Демонстрация аутентификации по API Key.
   - Демонстрация Rate Limiting.
   - Демонстрация блокировки после неудачных попыток входа.

5. **Комплект документации:**
   - Техническое задание (подписанное).
   - Спецификация API (Swagger/OpenAPI).
   - Руководство администратора.
   - Руководство по интеграции.
   - Инструкция по развёртыванию.
   - Исходный код (доступ к репозиторию).

**6.3. Критерии приёмки**

Работа считается выполненной при соблюдении следующих критериев:

1. Все функциональные требования из раздела 2.1 реализованы и работают корректно.
2. Нефункциональные требования из раздела 2.2 подтверждены тестированием.
3. Отсутствуют критические и блокирующие дефекты.
4. Документация соответствует текущей версии системы.
5. Исходный код передан Заказчику.

**6.4. Порядок устранения замечаний**

1. При обнаружении несоответствий комиссия составляет список замечаний.
2. Исполнитель устраняет замечания в течение 5 рабочих дней.
3. Проводится повторная приёмка.
4. Работа считается принятой после подписания Акта сдачи-приёмки работ обеими сторонами.

<a name="_heading=h.preparation"></a>**7. ТРЕБОВАНИЯ К СОСТАВУ И СОДЕРЖАНИЮ РАБОТ ПО ПОДГОТОВКЕ К ВВОДУ В ЭКСПЛУАТАЦИЮ**

**7.1. Подготовка инфраструктуры**

Заказчик обеспечивает:

1. **Серверное оборудование или облачные ресурсы:**
   - Минимальные требования: 2 vCPU, 4 GB RAM, 50 GB SSD.
   - Рекомендуемые требования: 4 vCPU, 8 GB RAM, 100 GB SSD.
   - Операционная система: Ubuntu 22.04 LTS или аналогичная.
   - Установленные Docker и Docker Compose.

2. **Сетевая инфраструктура:**
   - Статический IP-адрес или доменное имя.
   - Открытые порты: 80 (HTTP), 443 (HTTPS), 5432 (PostgreSQL — только внутренняя сеть).
   - SSL-сертификат для HTTPS.

3. **Учётные записи провайдеров:**
   - SMTP-сервер (логин, пароль, хост).
   - Telegram Bot Token (создаётся через @BotFather).
   - SMS-провайдер (API Key, при необходимости).
   - WhatsApp Business API (при необходимости).

**7.2. Настройка системы**

Исполнитель выполняет:

1. Развёртывание Docker-контейнеров на сервере Заказчика.
2. Первоначальную настройку базы данных.
3. Создание учётной записи первого администратора.
4. Настройку подключения к провайдерам каналов связи.
5. Проверку работоспособности всех компонентов.
6. Настройку резервного копирования.
7. Настройку мониторинга (при наличии системы мониторинга у Заказчика).

**7.3. Обучение персонала**

Исполнитель проводит:

1. Обучение администраторов работе с админ-панелью (2 часа).
2. Обучение разработчиков интеграции с API (2 часа).
3. Передача материалов для самостоятельного изучения.

**7.4. Ввод в опытную эксплуатацию**

1. Период опытной эксплуатации: 2 недели.
2. В период опытной эксплуатации Исполнитель оказывает консультационную поддержку.
3. По результатам опытной эксплуатации принимается решение о вводе в промышленную эксплуатацию.

<a name="_heading=h.ll3f4tprsmuc"></a>**8. ТРЕБОВАНИЯ К ДОКУМЕНТИРОВАНИЮ**

Комплект отчетной документации должен включать:

**8.1. Проектная документация**

1. **Техническое задание** (данный документ) — согласованная версия с подписями сторон.

2. **Схема базы данных** — ER-диаграмма со всеми таблицами и связями.

3. **Архитектурная документация** — описание компонентов системы и их взаимодействия.

**8.2. Документация API**

1. **Спецификация OpenAPI** (Swagger) — полное описание всех эндпоинтов в формате YAML/JSON.

2. **Интерактивная документация** — доступ к Swagger UI по адресу /swagger-ui на развёрнутом сервисе.

3. **Руководство по интеграции (Integration Guide):**
   - Описание процесса аутентификации.
   - Примеры запросов на всех поддерживаемых языках (curl, Python, JavaScript, Java).
   - Описание кодов ошибок и способов их обработки.
   - Рекомендации по реализации webhook-приёмника.
   - Best practices по интеграции.

**8.3. Эксплуатационная документация**

1. **Руководство администратора:**
   - Описание интерфейса админ-панели.
   - Инструкции по настройке каналов связи.
   - Инструкции по управлению API-клиентами.
   - Описание работы с журналом уведомлений.
   - Рекомендации по мониторингу и реагированию на инциденты.
   - Процедуры резервного копирования и восстановления.

2. **Инструкция по развёртыванию (Deployment Guide):**
   - Требования к серверу.
   - Пошаговая инструкция установки Docker.
   - Описание конфигурационных файлов.
   - Команды для запуска, остановки, обновления системы.
   - Инструкция по настройке HTTPS.
   - Инструкция по настройке резервного копирования.

3. **Инструкция по обновлению:**
   - Процедура обновления на новую версию.
   - Процедура отката на предыдущую версию.

**8.4. Формат документации**

- Все документы предоставляются в формате PDF и/или Markdown.
- Документация API — в формате OpenAPI 3.0 (YAML).
- Документация должна быть на русском языке.
- Технические термины могут использоваться на английском языке с пояснением.

**8.5. Передача документации**

- Документация передаётся в электронном виде.
- Документация размещается в репозитории вместе с исходным кодом.
- При необходимости предоставляется печатная версия руководств.

---

**ПОДПИСИ СТОРОН**

| | |
|---|---|
| **ЗАКАЗЧИК:** | **ИСПОЛНИТЕЛЬ:** |
| | |
| ___________________ / ____________ / | ___________________ / ____________ / |
| «___» _____________ 2025 г. | «___» _____________ 2025 г. |



